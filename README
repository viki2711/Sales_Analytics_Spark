
To execute a program, run main.py and the answers will be printed out.

Data processing steps:
---------------------------------------------------

Orders:
Pyspark for creating a spark session and a DataFrame

In order to create a schema for a spark Data Frame from text file, I built 2 python functions:
    1. clean_orders - for cleaning the rows (in clean_orders.py)
    2. parse_orders - for parsing the elements to the correct data types (in parse_orders.py)
        * parse functions for each data type imported from helpers.py

After the Data Frame was created, I used transformations to filter the data, aggregations to sum the needed data,
and actions to execute the previous functions.

---------------------------------------------------

Items:
    1. Reading a json file (open function from helpers.py)
    2. Pandas for creating a pandas data frame

----------------------------------------------------

Steps:
1. User who spent the most:
    * Grouped the user fields
    * Summed the priced they paid
    * Created a new column for this sum
    * Ordered by the descending value
    * Executed the first() action on this data and fetched the needed value for the answer

The answer is: User that spent the most: Marissa Jefferson, account_id = 143, 105.09$.

2. The most expensive item that was purchased by the user who spent the most:
    * Selected the relevant fields
    * Where user id matched from previous function
    * Ordered by the item cost
    * Executed the first() action on this data and fetched the needed value for the answer

The answer is: The most expensive item that user 143 purchased was: item_id = 2746, cost = 99.99$.

3. Marissa Washington:
    * Selected the relevant fields
    * Where the name and last name were matched
    * Grouped by the user fields
    * Summed the paid priced
    * Created a new column for this sum
    * Collected all the users that were a match with the name for the answer

The answer is:
Marissa Washington account_id = 145 , spent 26.97$.
Marissa Washington account_id = 125, spent 18.45$.







